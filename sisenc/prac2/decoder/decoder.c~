#include <inttypes.h>
#include <stdbool.h>
#include <avr/sfr_defs.h>
#include <avr/io.h>
#include <avr/interrupt.h>
#include <stdio.h>	
#include <string.h>
#include <stdint.h>
#include <stdbool.h>
#include <stdlib.h>
#include <ctype.h>
#include <pbn.h>



static pin_t a,b,c,d,e;

void setup(void){
  a=pin_create(&PORTB,0,Input);
  b=pin_create(&PORTB,1,Input);
  c=pin_create(&PORTB,2,Input);
  d=pin_create(&PORTB,3,Input);
  e=pin_create(&PORTB,4,Input);
  
  serial_open();
  sei();
}

int main(void){
  setup();
  pin_w(e,false);
  while (1) {
    if (pin_r(e)==1){
      if (pin_r(a)==0 && pin_r(b)==0 && pin_r(c)==0 && pin_r(d)==1){
	serial_put('1');
      }
      else if (pin_r(a)==0 && pin_r(b)==0 && pin_r(c)==1 && pin_r(d)==0){
	serial_put('2');
      }
      else if (pin_r(a)==0 && pin_r(b)==0 && pin_r(c)==1 && pin_r(d)==1){
	serial_put('3');
      }
      else if (pin_r(a)==1 && pin_r(b)==0 && pin_r(c)==1 && pin_r(d)==0){
	serial_put('A');
      }
      else if (pin_r(a)==0 && pin_r(b)==1 && pin_r(c)==0 && pin_r(d)==0){
	serial_put('4');
      }
      else if (pin_r(a)==0 && pin_r(b)==1 && pin_r(c)==0 && pin_r(d)==1){
	serial_put('5');
      }
      else if (pin_r(a)==0 && pin_r(b)==1 && pin_r(c)==1 && pin_r(d)==0){
	serial_put('6');
      }
      else if (pin_r(a)==1 && pin_r(b)==0 && pin_r(c)==1 && pin_r(d)==1){
	serial_put('B');
      }
      else if (pin_r(a)==0 && pin_r(b)==1 && pin_r(c)==1 && pin_r(d)==1){
	serial_put('7');
      }
      else if (pin_r(a)==1 && pin_r(b)==0 && pin_r(c)==0 && pin_r(d)==0){
	serial_put('8');
      }
      else if (pin_r(a)==1 && pin_r(b)==0 && pin_r(c)==0 && pin_r(d)==1){
	serial_put('9');
      }
      else if (pin_r(a)==1 && pin_r(b)==1 && pin_r(c)==0 && pin_r(d)==0){
	serial_put('C');
      }
      else if (pin_r(a)==1 && pin_r(b)==1 && pin_r(c)==1 && pin_r(d)==0){
	serial_put('*');
      }
      else if (pin_r(a)==1 && pin_r(b)==1 && pin_r(c)==1 && pin_r(d)==1){
	serial_put('#');
      }
      else if (pin_r(a)==0 && pin_r(b)==0 && pin_r(c)==0 && pin_r(d)==0){
	serial_put('0');
      }
      else if (pin_r(a)==1 && pin_r(b)==1 && pin_r(c)==0 && pin_r(d)==1){
	serial_put('D');
      }
      else {
	serial_put('-');
      }
    }
  }
}
